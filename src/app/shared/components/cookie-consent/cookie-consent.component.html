<div *ngIf="isVisible" class="fixed bottom-6 left-6 right-6 md:left-auto md:right-8 md:max-w-md z-[100] animate-in fade-in slide-in-from-bottom-8 duration-500">
  <div class="bg-[#1a1a1a] text-white p-6 rounded-2xl shadow-2xl border border-white/10 relative overflow-hidden">
    <!-- Close Button -->
    <button (click)="close()" class="absolute top-4 right-4 text-slate-500 hover:text-white transition-colors">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
    </button>

    <!-- Main View -->
    <div *ngIf="!showSettings" class="flex gap-4">
      <div class="shrink-0 w-12 h-12 bg-white/5 rounded-full flex items-center justify-center text-slate-400">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5" />
          <path d="M8.5 8.5v.01" /><path d="M16 15.5v.01" /><path d="M12 12v.01" /><path d="M11 17v.01" /><path d="M7 14v.01" />
        </svg>
      </div>

      <div class="flex-1">
        <p class="text-sm leading-relaxed text-slate-300 pr-6">
          Ce site utilise des cookies pour améliorer votre expérience utilisateur. Découvrez comment nous utilisons les cookies dans notre 
          <a routerLink="/privacy" class="text-orange-500 font-bold hover:underline decoration-orange-500/30">Avis sur les cookies</a>.
        </p>

        <div class="mt-6 flex flex-col sm:flex-row gap-3">
          <button (click)="toggleSettings()" class="flex-1 px-4 py-3 bg-transparent border border-white/20 hover:border-white/40 text-white rounded-lg text-sm font-bold text-center transition-all">
            Personnaliser
          </button>
          <button (click)="acceptAll()" class="flex-1 px-4 py-3 bg-white text-black hover:bg-slate-200 rounded-lg text-sm font-bold text-center transition-all">
            OK!
          </button>
        </div>
      </div>
    </div>

    <!-- Personalization View -->
    <div *ngIf="showSettings" class="space-y-6 animate-in fade-in transition-all">
      <div class="flex items-center gap-2 mb-2">
        <button (click)="toggleSettings()" class="text-slate-400 hover:text-white mr-1">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
        </button>
        <h3 class="font-bold text-white text-lg">Préférences Cookies</h3>
      </div>

      <div class="space-y-4 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar">
        <!-- Essential -->
        <div class="flex items-start justify-between gap-4 p-3 rounded-xl bg-white/5 border border-white/5">
          <div class="flex-1">
            <div class="font-bold text-sm text-white">Essentiels (Toujours actifs)</div>
            <div class="text-[10px] text-slate-500 leading-tight mt-1">Nécessaires au fonctionnement du site, à la sécurité et à votre session de jeu.</div>
          </div>
          <div class="w-10 h-6 bg-blue-600 rounded-full flex items-center px-1 opacity-50 cursor-not-allowed">
            <div class="w-4 h-4 bg-white rounded-full translate-x-4"></div>
          </div>
        </div>

        <!-- Analytics -->
        <div class="flex items-start justify-between gap-4 p-3 rounded-xl hover:bg-white/5 transition-colors border border-transparent hover:border-white/5 cursor-pointer" (click)="preferences.analytics = !preferences.analytics">
          <div class="flex-1">
            <div class="font-bold text-sm text-white">Analytiques</div>
            <div class="text-[10px] text-slate-500 leading-tight mt-1">Nous permettent de garder des traces des pages visitées pour améliorer votre expérience.</div>
          </div>
          <div class="relative inline-flex h-6 w-10 shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 focus:outline-none" [ngClass]="preferences.analytics ? 'bg-orange-500' : 'bg-slate-700'">
            <span class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out" [ngClass]="preferences.analytics ? 'translate-x-4' : 'translate-x-0'"></span>
          </div>
        </div>

        <!-- Marketing -->
        <div class="flex items-start justify-between gap-4 p-3 rounded-xl hover:bg-white/5 transition-colors border border-transparent hover:border-white/5 cursor-pointer" (click)="preferences.marketing = !preferences.marketing">
          <div class="flex-1">
            <div class="font-bold text-sm text-white">Publicitaires</div>
            <div class="text-[10px] text-slate-500 leading-tight mt-1">Utilisés pour vous proposer des annonces de tournois pertinentes.</div>
          </div>
          <div class="relative inline-flex h-6 w-10 shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 focus:outline-none" [ngClass]="preferences.marketing ? 'bg-orange-500' : 'bg-slate-700'">
            <span class="pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out" [ngClass]="preferences.marketing ? 'translate-x-4' : 'translate-x-0'"></span>
          </div>
        </div>
      </div>

      <button (click)="savePreferences()" class="w-full px-4 py-3 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-sm font-black uppercase tracking-tighter transition-all">
        Enregistrer mes choix
      </button>
    </div>
  </div>
</div>
