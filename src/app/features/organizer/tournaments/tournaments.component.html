<div class="min-h-screen bg-slate-950 pt-24 pb-12">
  <div class="list-container">
    
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10">
      <div>
        <h1 class="text-3xl font-bold text-white mb-2">Vos Tournois</h1>
        <p class="text-slate-400">G√©rez vos comp√©titions et suivez les participants.</p>
      </div>
      <a routerLink="/organizer/create-tournament" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Nouveau Tournoi
      </a>
    </div>

    <div class="filter-bar">
      <button (click)="applyFilter('all')" class="filter-btn" [class.active]="activeFilter === 'all'">Tout</button>
      <button (click)="applyFilter('open')" class="filter-btn" [class.active]="activeFilter === 'open'">Inscriptions</button>
      <button (click)="applyFilter('in_progress')" class="filter-btn" [class.active]="activeFilter === 'in_progress'">En cours</button>
      <button (click)="applyFilter('completed')" class="filter-btn" [class.active]="activeFilter === 'completed'">Termin√©s</button>
    </div>

    <div *ngIf="loading" class="flex justify-center py-20">
      <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
    </div>

    <div *ngIf="!loading && filteredTournaments.length === 0" class="text-center py-20 bg-slate-900/50 rounded-3xl border border-slate-800">
      <div class="text-slate-500 text-4xl mb-4">üèÜ</div>
      <p class="text-slate-400 text-lg">Aucun tournoi trouv√© dans cette cat√©gorie.</p>
    </div>

    <div *ngIf="!loading && filteredTournaments.length > 0" class="tournament-grid">
      <div *ngFor="let t of filteredTournaments" class="tournament-card group">
        <div class="card-image">
          <div class="absolute inset-0 bg-gradient-to-t from-slate-950 to-transparent opacity-60"></div>
          <span class="text-4xl">üéÆ</span>
          <div class="absolute top-4 right-4">
             <span class="badge" [ngClass]="t.status | tournamentStatusClass">
                  {{ t.status | tournamentStatus }}
             </span>
          </div>
        </div>
        
        <div class="card-content">
          <h3 class="text-xl font-bold text-white mb-2 group-hover:text-blue-400 transition-colors">{{ t.name }}</h3>
          <div class="flex items-center gap-2 mb-2">
            <span class="text-xs font-bold px-2 py-1 rounded bg-slate-800" [ngClass]="t.game | gameColor">
              {{ t.game | gameName }}
            </span>
          </div>
          <div class="flex items-center gap-4 text-slate-400 text-sm mb-4">
            <span class="flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
              {{ t.start_date | date:'shortDate' }}
            </span>
          </div>

          <div class="flex items-center justify-between p-3 rounded-xl bg-slate-800/50 mb-6">
            <div class="text-xs text-slate-500 uppercase font-bold tracking-wider">Inscrits</div>
            <div class="text-white font-bold">{{ t.current_participants || 0 }} / {{ t.max_participants }}</div>
          </div>

          <div class="flex gap-2">
            <a [routerLink]="['/organizer/tournaments', t.id]" class="flex-1 bg-slate-800 hover:bg-slate-700 text-white text-center py-2.5 rounded-lg text-sm font-bold transition-colors">
              G√©rer
            </a>
            <button (click)="openActionModal(t, $event)" class="p-2.5 rounded-lg bg-slate-800 hover:bg-slate-700 text-slate-400 transition-colors">
              <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/></svg>
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Action Modal -->
  <div *ngIf="showActionModal" class="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-950/80 backdrop-blur-sm" (click)="closeActionModal()">
    <div class="w-full max-w-sm bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl overflow-hidden" (click)="$event.stopPropagation()">
      <div class="p-6 border-b border-slate-800">
        <h3 class="text-xl font-bold text-white mb-1">{{ selectedTournament?.name }}</h3>
        <p class="text-slate-400 text-sm">Choisissez une action rapide</p>
      </div>

      <div class="p-4 space-y-2">
        <!-- Draft -> Open -->
        <button *ngIf="selectedTournament?.status === 'draft'" 
                (click)="publishTournament()" 
                [disabled]="processingAction"
                class="w-full flex items-center gap-3 p-4 rounded-xl hover:bg-blue-600/10 text-slate-300 hover:text-blue-400 transition-all border border-transparent hover:border-blue-500/20 group">
          <span class="w-10 h-10 rounded-lg bg-blue-500/20 text-blue-400 flex items-center justify-center font-bold">üöÄ</span>
          <div class="text-left">
            <div class="font-bold">Ouvrir les inscriptions</div>
            <div class="text-xs text-slate-500 group-hover:text-blue-400/60">Passe le tournoi en mode public</div>
          </div>
        </button>

        <!-- Open -> In Progress -->
        <button *ngIf="selectedTournament?.status === 'open'" 
                (click)="launchTournament()" 
                [disabled]="processingAction"
                class="w-full flex items-center gap-3 p-4 rounded-xl hover:bg-green-600/10 text-slate-300 hover:text-green-400 transition-all border border-transparent hover:border-green-500/20 group">
          <span class="w-10 h-10 rounded-lg bg-green-500/20 text-green-400 flex items-center justify-center font-bold">‚öîÔ∏è</span>
          <div class="text-left">
            <div class="font-bold">Lancer le tournoi</div>
            <div class="text-xs text-slate-500 group-hover:text-green-400/60">G√©n√®re les matches et d√©marre le Round 1</div>
          </div>
        </button>

        <a [routerLink]="['/organizer/tournaments', selectedTournament?.id]" 
           class="w-full flex items-center gap-3 p-4 rounded-xl hover:bg-slate-800 text-slate-300 transition-all group">
          <span class="w-10 h-10 rounded-lg bg-slate-800 text-slate-400 flex items-center justify-center font-bold">‚öôÔ∏è</span>
          <div class="text-left">
            <div class="font-bold">Gestion compl√®te</div>
            <div class="text-xs text-slate-500">Acc√©der √† tous les r√©glages</div>
          </div>
        </a>
      </div>

      <div class="p-4 bg-slate-900/50 border-t border-slate-800">
        <button (click)="closeActionModal()" class="w-full py-2.5 text-slate-400 hover:text-white font-medium transition-colors">
          Annuler
        </button>
      </div>
    </div>
  </div>
</div>
